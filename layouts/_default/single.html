{{- define "main" -}}

<div class="cc-progress" aria-hidden="true"><div class="cc-progress__bar" id="cc-progress-bar"></div></div>
<script>
  (function () {
    const bar = document.getElementById('cc-progress-bar');
    if (!bar) return;

    function update() {
      const doc = document.documentElement;
      const scrollTop = (window.pageYOffset || doc.scrollTop || 0);
      const height = Math.max(doc.scrollHeight - doc.clientHeight, 1);
      const pct = Math.min(100, Math.max(0, (scrollTop / height) * 100));
      bar.style.width = pct.toFixed(2) + '%';
    }

    update();
    window.addEventListener('scroll', update, { passive: true });
    window.addEventListener('resize', update);
  })();
</script>

<article class="post-single cc-single">
  <header class="post-header cc-post-header">
    <h1 class="post-title">{{ .Title }}</h1>
    {{- partial "post_meta.html" . -}}

    {{- if .Params.cover -}}
      <div class="cc-cover">
        {{- partial "cover.html" (dict "cxt" . "IsHome" false "isHidden" false) -}}
      </div>
    {{- end -}}
  </header>

  <div class="cc-single__layout">
    <div class="cc-single__content">
      {{- if .Params.ShowToc -}}
        <div class="cc-toc-mobile">
          {{- partial "toc.html" . -}}
        </div>
      {{- end -}}

      <div class="post-content">
        {{ .Content }}
      </div>

      {{- partial "cc-related.html" . -}}

      {{- if (and site.Params.ShowPostNavLinks (or .NextInSection .PrevInSection)) -}}
        {{- partial "post_nav_links.html" . -}}
      {{- end -}}
    </div>

    {{- if .Params.ShowToc -}}
      <div class="cc-single__sidebar">
        {{- partial "toc-sticky.html" . -}}
      </div>
    {{- end -}}
  </div>

</article>

{{- end -}}
